{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Report Card Generator Pro application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Full name of the user."
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "UserSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserSettings",
      "type": "object",
      "description": "Stores customizable settings for generating report cards for a specific user.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The UID of the user these settings belong to."
        },
        "schoolName": {
          "type": "string"
        },
        "schoolAddress": {
            "type": "string"
        },
        "sessionYear": {
          "type": "string"
        },
        "themeColor": {
          "type": "string"
        },
        "schoolLogo": {
          "type": "string",
          "format": "uri-reference"
        },
        "teacherSignature": {
          "type": "string",
          "format": "uri-reference"
        },
        "principalSignature": {
          "type": "string",
          "format": "uri-reference"
        },
        "gradeRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "grade": { "type": "string" },
              "minPercentage": { "type": "number" }
            },
            "required": ["id", "grade", "minPercentage"]
          }
        }
      },
      "required": [
        "userId",
        "schoolName",
        "sessionYear",
        "themeColor",
        "gradeRules"
      ]
    },
    "ReportCardHistory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ReportCardHistory",
      "type": "object",
      "description": "Stores a history of generated report cards for a specific user.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The UID of the user this history item belongs to."
        },
        "fileName": {
          "type": "string"
        },
        "date": {
          "type": "string",
          "format": "date-time"
        },
        "fileCount": {
          "type": "number"
        },
        "studentsData": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "The timestamp of when the history was created."
        }
      },
      "required": [
        "userId",
        "fileName",
        "date",
        "fileCount",
        "studentsData",
        "createdAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores public user profile information. The document ID must be the user's UID."
        }
      },
      {
        "path": "/user_settings/{userId}",
        "definition": {
          "entityName": "UserSettings",
          "schema": {
            "$ref": "#/backend/entities/UserSettings"
          },
          "description": "Stores user-specific settings. The document ID must be the user's UID."
        }
      },
      {
        "path": "/report_card_history/{historyId}",
        "definition": {
          "entityName": "ReportCardHistory",
          "schema": {
            "$ref": "#/backend/entities/ReportCardHistory"
          },
          "description": "A collection storing all report card generation events. Secured by a 'userId' field within the document."
        }
      }
    ]
  }
}
